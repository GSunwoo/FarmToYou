<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.farm.service.IMemberService">
	
	<select id="loginCheck"
		resultType="com.farm.dto.MemberDTO">
		SELECT user_id, user_pw, user_type, enable, member_id
			FROM member WHERE user_id = #{userId}
	</select>
	
	<select id="selectBuyerData"
		parameterType="com.farm.dto.MemberDTO"
		resultType="com.farm.dto.MemberDTO">
		SELECT user_id, user_pw, user_type, enable, phone_num,
				name, emailid, emaildomain, member_id, trust_score, regidate
		FROM member
		WHERE user_id = #{user_id} 
	</select>
	<select id="selectSellerData"
		parameterType="com.farm.dto.MemberDTO"
		resultType="com.farm.dto.MemberDTO">
		SELECT user_id, user_pw, user_type, enable, phone_num,
				name, emailid, emaildomain, member_id, regidate
		FROM member
		WHERE user_id = #{user_id} 
	</select>
	
	<select id="selectAddress"
		resultType="com.farm.dto.AddressDTO">
	SELECT * 
	FROM address
	WHERE member_id=#{member_id}
	</select>
	<select id="selectAddressMain"
		resultType="com.farm.dto.AddressDTO">
	SELECT * 
	FROM address
	WHERE member_id=#{member_id} AND main=1
	</select>
	
	<insert id="insertAddress"
		parameterType="com.farm.dto.AddressDTO">
		INSERT INTO address (addr_id, zipcode, addr1, addr2, main, member_id)
			VALUES (seq_address_id.nextval, #{zipcode}, #{addr1}, #{addr2}, #{main}, #{member_id})
	</insert>
	
	<update id="updateMainToZero">
	UPDATE address
	SET main=0
	WHERE member_id=#{member_id}
	</update>
	
	<update id="updateMain">
	UPDATE address
	SET main=1
	WHERE addr_id=#{addr_id}
	</update>
	
	<delete id="delete">
	DELETE FROM address
	WHERE addr_id=#{addr_id}
	</delete>
</mapper>
